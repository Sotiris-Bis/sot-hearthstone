<template>
  <div>
    <!-- <p> {{arenaCards}}</p> -->
    <button @click="filterCards">filter</button>
    <!-- <ol>
            <li v-for="card in arenaCards" :key="card.id">
                {{card.name}}
            </li>
        </ol> -->
    <!-- <div class="container">
      <b-container fluid>

        <b-table
          :items="arenaCards"
          :fields="fields"
          :filter="filter"
          :filter-included-fields="filterOn"
          :sort-by.sync="sortBy"
          :sort-desc.sync="sortDesc"
          :sort-direction="sortDirection"
          stacked="md"
          show-empty
          small
          :busy="isBusy"
        >
          <template #cell(index)="row">
            {{ row.index + 1 }}
          </template>
          <template #cell(name)="row">
            {{ row.value }}
          </template>
          <template #cell(text)="row">
            <span v-html="row.value"></span>
          </template>
          <template #cell(minionTypeId)="row">
            <span v-bind="lol"> {{ returnType(row.item.minionTypeId) }} </span>
          </template>
          <template #cell(classType)="row">
            <span v-bind="lol"> {{ classType(row.item.classId) }} </span>
          </template>

          <template #cell(actions)="row">
            <b-button size="sm" @click="info(row.item, row.index, $event.target)" class="mr-1">
              Info modal
            </b-button>
            <b-button size="sm" @click="row.toggleDetails"> {{ row.detailsShowing ? 'Hide' : 'Show' }} Details </b-button>
          </template>

          <template #row-details="row">
            <b-card>
              <b-img-lazy center :src="row.item.image" width="181," height="250,"></b-img-lazy>
            </b-card>
          </template>

          <template #table-busy>
            <div class="text-center text-danger my-2">
              <b-spinner class="align-middle"></b-spinner>
              <strong>Loading...</strong>
            </div>
          </template>
        </b-table>

        <b-modal :id="infoModal.id" :title="infoModal.title" ok-only @hide="resetInfoModal">
          <b-img-lazy center :src="infoModal.content"></b-img-lazy>
        </b-modal>
      </b-container>
    </div>
        -->

    <!-- <div class="container">
          <b-card-group columns>
              <b-card v-for="card in arenaCards"
              :key="card.id"
                    :img-src="card.image"
                    :img-alt="card.name" 
                    img-top
                      align="center"
                  >
                  <b-card-text>
                      <p :v-html="card.text"></p>
                  </b-card-text>
              </b-card>

          </b-card-group>
        </div> -->
    <div class="container">
      <b-container fluid>
        <b-img-lazy v-for="card in arenaCards" :key="card.id" :src="card.image" :alt="card.name" width="217" height="300"></b-img-lazy>
      </b-container>
    </div>
  </div>
</template>
<script>
import axios from 'axios';
export default {
  name: 'newArena',
  data() {
    return {
      arenaCards: [],
      cards: [],
      fields: [
        'index',
        { key: 'name', sortable: true },
        { key: 'text' },
        { key: 'manaCost', sortable: true },
        { key: 'actions', label: 'Actions' },
        { key: 'minionTypeId', label: 'Minion Type ', sortable: true },
        { key: 'classType' }
      ],
      lol: '',
      isBusy: false,
      totalRows: 1,
      currentPage: 1,
      perPage: 5,
      pageOptions: [5, 10, 15, 50, 100],
      sortBy: '',
      sortDesc: false,
      sortDirection: 'asc',
      filter: null,
      filterOn: [],
      infoModal: {
        id: 'info-modal',
        title: '',
        content: ''
      },
      arenaIds: [
        7,
        8,
        12,
        22,
        23,
        28,
        30,
        31,
        32,
        34,
        36,
        37,
        41,
        45,
        48,
        51,
        61,
        64,
        67,
        68,
        69,
        70,
        75,
        77,
        86,
        90,
        95,
        113,
        132,
        134,
        138,
        140,
        141,
        145,
        147,
        149,
        151,
        157,
        158,
        163,
        175,
        178,
        179,
        180,
        186,
        189,
        191,
        195,
        201,
        205,
        211,
        213,
        216,
        220,
        232,
        238,
        239,
        242,
        250,
        251,
        254,
        257,
        268,
        272,
        274,
        279,
        281,
        282,
        284,
        285,
        286,
        287,
        289,
        290,
        291,
        292,
        296,
        299,
        304,
        306,
        308,
        311,
        315,
        336,
        338,
        339,
        344,
        345,
        348,
        351,
        352,
        363,
        365,
        366,
        376,
        381,
        383,
        389,
        391,
        394,
        395,
        397,
        400,
        401,
        404,
        405,
        411,
        413,
        415,
        420,
        421,
        424,
        430,
        435,
        436,
        437,
        440,
        443,
        445,
        447,
        453,
        455,
        456,
        457,
        459,
        461,
        462,
        466,
        467,
        469,
        475,
        476,
        481,
        493,
        496,
        503,
        505,
        510,
        511,
        512,
        513,
        517,
        519,
        523,
        525,
        526,
        531,
        538,
        546,
        555,
        556,
        564,
        567,
        570,
        573,
        577,
        581,
        582,
        584,
        585,
        587,
        592,
        594,
        596,
        601,
        602,
        605,
        606,
        608,
        609,
        613,
        614,
        618,
        621,
        622,
        629,
        630,
        635,
        636,
        637,
        640,
        641,
        642,
        643,
        648,
        654,
        658,
        662,
        667,
        670,
        671,
        672,
        680,
        692,
        699,
        700,
        708,
        710,
        712,
        715,
        724,
        727,
        739,
        742,
        748,
        749,
        753,
        755,
        756,
        757,
        759,
        762,
        763,
        765,
        766,
        767,
        768,
        773,
        774,
        777,
        778,
        783,
        785,
        790,
        791,
        797,
        801,
        804,
        810,
        811,
        813,
        814,
        818,
        823,
        830,
        834,
        836,
        841,
        847,
        854,
        855,
        859,
        860,
        864,
        866,
        877,
        878,
        886,
        887,
        890,
        891,
        893,
        896,
        903,
        904,
        906,
        912,
        914,
        915,
        919,
        920,
        921,
        922,
        926,
        930,
        932,
        940,
        943,
        950,
        960,
        962,
        969,
        971,
        974,
        976,
        979,
        982,
        985,
        994,
        995,
        997,
        999,
        1003,
        1004,
        1007,
        1008,
        1009,
        1014,
        1019,
        1022,
        1023,
        1026,
        1029,
        1035,
        1037,
        1047,
        1050,
        1063,
        1064,
        1066,
        1068,
        1073,
        1074,
        1080,
        1084,
        1087,
        1090,
        1091,
        1092,
        1093,
        1098,
        1099,
        1100,
        1108,
        1109,
        1117,
        1122,
        1124,
        1133,
        1135,
        1140,
        1141,
        1142,
        1144,
        1147,
        1155,
        1158,
        1167,
        1171,
        1174,
        1182,
        1186,
        1189,
        1221,
        1241,
        1243,
        1261,
        1281,
        1362,
        1363,
        1364,
        1366,
        1367,
        1369,
        1370,
        1371,
        1373,
        1401,
        1522,
        1634,
        1651,
        1653,
        1655,
        1656,
        1657,
        1658,
        1662,
        1686,
        1687,
        1688,
        1693,
        1737,
        52255,
        52262,
        52263,
        52264,
        51371,
        51372,
        51373,
        51375,
        51376,
        51380,
        51567,
        51705,
        51714,
        51715,
        51722,
        51724,
        51727,
        51733,
        51734,
        51735,
        51737,
        51738,
        51739,
        51757,
        51761,
        51769,
        51779,
        51781,
        51790,
        51791,
        51795,
        51827,
        51847,
        51943,
        51966,
        51971,
        51977,
        52058,
        52070,
        52072,
        52076,
        52081,
        52082,
        52086,
        52089,
        52091,
        52109,
        52111,
        52112,
        52114,
        52119,
        52148,
        52277,
        52278,
        52281,
        52285,
        52286,
        52287,
        52288,
        52289,
        52290,
        52292,
        52295,
        52296,
        52306,
        52307,
        52312,
        52409,
        52413,
        52415,
        52417,
        52418,
        52420,
        52421,
        52422,
        52434,
        52438,
        52468,
        52479,
        52480,
        52482,
        52486,
        52487,
        52490,
        52494,
        52496,
        52500,
        52502,
        52603,
        52606,
        52616,
        52617,
        52627,
        52632,
        52633,
        52636,
        52638,
        52639,
        52640,
        52654,
        52660,
        52679,
        52685,
        52698,
        52706,
        52707,
        52715,
        52742,
        52790,
        52809,
        52810,
        52819,
        52866,
        52870,
        52871,
        52872,
        52873,
        52894,
        52902,
        52935,
        52936,
        52940,
        52942,
        52943,
        52950,
        52954,
        52991,
        53002,
        53024,
        53099,
        53104,
        53124,
        53138,
        53171,
        53173,
        53179,
        53218,
        53249,
        53251,
        56047,
        53336,
        53343,
        53379,
        53402,
        53407,
        53408,
        53409,
        53413,
        53435,
        53438,
        53439,
        53442,
        53445,
        53496,
        53545,
        53551,
        53576,
        53582,
        53596,
        53609,
        53613,
        53615,
        53620,
        53627,
        53661,
        53739,
        53756,
        53771,
        53778,
        53788,
        53791,
        53796,
        53800,
        53822,
        53823,
        53827,
        53832,
        53860,
        53861,
        53882,
        53883,
        53884,
        53885,
        53887,
        53889,
        53890,
        53907,
        53917,
        53919,
        53922,
        53924,
        53926,
        53929,
        53932,
        53933,
        53935,
        53938,
        53942,
        53945,
        53947,
        53967,
        53969,
        53970,
        53971,
        53972,
        53973,
        53974,
        53978,
        53979,
        53985,
        53990,
        54000,
        54002,
        54009,
        54011,
        54013,
        54015,
        54016,
        54020,
        54037,
        54038,
        54077,
        54147,
        54148,
        54153,
        54154,
        54160,
        54191,
        54204,
        54256,
        54257,
        54259,
        54260,
        54261,
        54264,
        54265,
        54267,
        54269,
        54272,
        54273,
        54274,
        54276,
        54278,
        54280,
        54284,
        54288,
        54291,
        54296,
        54311,
        54314,
        54317,
        54369,
        54386,
        54389,
        54390,
        54391,
        54408,
        54411,
        54424,
        54425,
        54426,
        54427,
        54429,
        54431,
        54433,
        54488,
        54489,
        54492,
        54493,
        54495,
        54730,
        54749,
        54772,
        54783,
        54806,
        54833,
        54834,
        54835,
        54836,
        54837,
        54838,
        54839,
        54840,
        54865,
        54863,
        56189,
        54871,
        54872,
        54873,
        54874,
        54876,
        54885,
        54888,
        54887,
        54890,
        54891,
        54892,
        54893,
        54894,
        54896,
        54897,
        54898,
        54901,
        54904,
        54906,
        54907,
        54909,
        54917,
        54919,
        54922,
        54923,
        54924,
        54926,
        54935,
        54956,
        54960,
        54965,
        54966,
        54967,
        54969,
        54971,
        55000,
        55001,
        55002,
        55003,
        55004,
        55005,
        55006,
        55007,
        55021,
        55024,
        55030,
        55031,
        55033,
        55035,
        55036,
        55037,
        55038,
        55039,
        55047,
        55048,
        55052,
        55056,
        55067,
        55068,
        55069,
        55072,
        55094,
        55095,
        55097,
        55099,
        55101,
        55102,
        55103,
        55104,
        55105,
        55161,
        55166,
        55208,
        55210,
        55245,
        55246,
        55248,
        55250,
        55251,
        55262,
        55276,
        55280,
        55281,
        55283,
        55288,
        55291,
        55292,
        55294,
        55301,
        55303,
        55304,
        55342,
        55399,
        55400,
        55401,
        55402,
        55403,
        55404,
        55405,
        55406,
        55407,
        55408,
        55414,
        55415,
        55416,
        55417,
        55418,
        55419,
        55420,
        55421,
        55422,
        55423,
        55424,
        55425,
        55426,
        55427,
        55428,
        55429,
        55431,
        55432,
        55436,
        55438,
        55441,
        55446,
        55454,
        55466,
        55470,
        55640,
        55643,
        55907,
        55935,
        55975,
        56161,
        56226,
        57329,
        57413,
        57416,
        57419,
        57427,
        56057,
        56063,
        56064,
        56067,
        56068,
        56071,
        56072,
        56076,
        56077,
        56086,
        56088,
        56089,
        56090,
        56091,
        56093,
        56094,
        56098,
        56100,
        56101,
        56107,
        56109,
        56112,
        56114,
        56116,
        56118,
        56120,
        56122,
        56131,
        56135,
        56239,
        56262,
        56292,
        56294,
        56307,
        56438,
        56377,
        56378,
        56379,
        56385,
        56386,
        56387,
        56389,
        56391,
        56392,
        56393,
        56394,
        56398,
        56411,
        56412,
        56413,
        56417,
        56420,
        56439,
        56443,
        56444,
        56445,
        56451,
        56460,
        56461,
        56467,
        56470,
        56471,
        56472,
        56482,
        56483,
        56484,
        56501,
        56502,
        56504,
        56507,
        56508,
        56510,
        56511,
        56512,
        56516,
        56519,
        56520,
        56523,
        56524,
        56526,
        56527,
        56528,
        56530,
        56534,
        56554,
        56555,
        56556,
        56595,
        56598,
        56603,
        56622,
        56623,
        56624,
        56632,
        56649,
        56660,
        56676,
        56677,
        56678,
        56680,
        56682,
        56681,
        56684,
        56685,
        56686,
        56687,
        56689,
        56694,
        56697,
        56703,
        56717,
        56732,
        56734,
        56758,
        56819,
        56820,
        56823,
        56824,
        56827,
        56860,
        56899,
        56900,
        56985,
        57145,
        57149,
        57160,
        57165,
        57166,
        57174,
        57175,
        57176,
        57177,
        57180,
        57181,
        57182,
        57183,
        57184,
        57186,
        57187,
        57188,
        57189,
        57190,
        57191,
        57192,
        57193,
        57194,
        57195,
        57197,
        57217,
        57326,
        57476,
        57546,
        57619,
        57688,
        57718,
        57721,
        57907,
        57950,
        57979,
        58201,
        58202,
        58243,
        58453,
        58455,
        58495,
        58549,
        59864,
        59869,
        60280,
        58170,
        56587,
        56652,
        56739,
        56765,
        56841,
        56873,
        56905,
        56928,
        58172,
        58183,
        58244,
        58246,
        58452,
        58487,
        58492,
        58524,
        58610,
        59710,
        59865,
        58607,
        56550,
        57732,
        56791,
        56583,
        56973,
        56806,
        56792,
        58489,
        59867,
        58494,
        57847,
        60068,
        60069,
        60070,
        60071,
        60066,
        60067
      ]
    };
  },
  mounted() {
    console.log(this.arenaIds.length);
  },
  beforeCreate() {
    const token = this.$store.state.oauth.accessToken;
    axios
      .get(`https://us.api.blizzard.com/hearthstone/cards?locale=en_US&pageSize=500&access_token=${token}`)
      .then(res => {
        // console.log(res.data.pageCount);
        for (let page = 1; page <= res.data.pageCount; page++) {
          axios
            .get(`https://us.api.blizzard.com/hearthstone/cards?locale=en_US&collectible=1&page=${page}&pageSize=500&access_token=${token}`)
            .then(res => {
              // console.log(res.data);
              this.cards.push(...res.data.cards);
            });
        }
      })

      .catch(e => {
        console.log(e.message);
      });
  },
  methods: {
    filterCards() {
      let yFilter = this.arenaIds.map(itemId => {
        return itemId;
      });
      let filteredX = this.cards.filter(itemX => yFilter.includes(itemX.id));
      this.arenaCards = filteredX;

      console.log(filteredX);
      this.sortFunc();
    },
    sortFunc() {
      return this.arenaCards.sort(function(a, b) {
        return a.manaCost > b.manaCost ? 1 : -1;
      });
    },
    toggleBusy() {
      this.isBusy = !this.isBusy;
    },

    info(item, index, button) {
      this.infoModal.title = item.name;
      this.infoModal.content = item.image;
      this.$root.$emit('bv::show::modal', this.infoModal.id, button);
    },
    resetInfoModal() {
      this.infoModal.title = '';
      this.infoModal.content = '';
    },
    returnType(number) {
      switch (number) {
        case 14:
          return 'Murloc';
        case 15:
          return 'Demon';

        case 17:
          return 'Mech';

        case 18:
          return 'Elemental';

        case 20:
          return 'Beast';

        case 21:
          return 'Totem';

        case 23:
          return 'Pirate';

        case 24:
          return 'Dragon';

        case 26:
          return 'All';
        default:
          return '';
      }
    },
    classType(number) {
      switch (number) {
        case 14:
          return 'Demon Hunter';
        case 2:
          return 'Druid';
        case 3:
          return 'Hunter';
        case 4:
          return 'Mage';
        case 5:
          return 'Paladin';
        case 6:
          return 'Priest';
        case 7:
          return 'Rogue';
        case 8:
          return 'Shaman';
        case 9:
          return 'Warlock';
        case 10:
          return 'Warrior';
        case 12:
          return 'Neutral';
      }
    }
  }
};
</script>
